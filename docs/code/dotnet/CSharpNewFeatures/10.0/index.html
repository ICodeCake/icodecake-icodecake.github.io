<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/images/logo.png"><title>CSharp 10.0 新特性 | Code Cake</title><meta name="description" content="代码分享">
    <link rel="modulepreload" href="/assets/app.cbfe9412.js"><link rel="modulepreload" href="/assets/index.html.a4666be7.js"><link rel="modulepreload" href="/assets/index.html.ce3db78c.js"><link rel="prefetch" href="/assets/index.html.b5b50aed.js"><link rel="prefetch" href="/assets/index.html.82c10bf5.js"><link rel="prefetch" href="/assets/markdown.html.373131ab.js"><link rel="prefetch" href="/assets/index.html.0f8400b2.js"><link rel="prefetch" href="/assets/index.html.293851e8.js"><link rel="prefetch" href="/assets/index.html.d5708d20.js"><link rel="prefetch" href="/assets/index.html.16e3fdc9.js"><link rel="prefetch" href="/assets/index.html.093bbf26.js"><link rel="prefetch" href="/assets/index.html.7133a7ec.js"><link rel="prefetch" href="/assets/CodeReadability.html.e0c8ecb4.js"><link rel="prefetch" href="/assets/CodeReview.html.148be5a3.js"><link rel="prefetch" href="/assets/CSharpCodingStyle.html.db2bbb9b.js"><link rel="prefetch" href="/assets/index.html.10e573d6.js"><link rel="prefetch" href="/assets/UnitTesting.html.448518f1.js"><link rel="prefetch" href="/assets/index.html.64bac6cb.js"><link rel="prefetch" href="/assets/index.html.7730f91b.js"><link rel="prefetch" href="/assets/index.html.197fa484.js"><link rel="prefetch" href="/assets/index.html.19d60b55.js"><link rel="prefetch" href="/assets/index.html.e0b02fac.js"><link rel="prefetch" href="/assets/index.html.b836efc4.js"><link rel="prefetch" href="/assets/index.html.c828d055.js"><link rel="prefetch" href="/assets/index.html.8b0be331.js"><link rel="prefetch" href="/assets/index.html.42e40658.js"><link rel="prefetch" href="/assets/index.html.afd1fb01.js"><link rel="prefetch" href="/assets/index.html.0c10a718.js"><link rel="prefetch" href="/assets/index.html.033b940a.js"><link rel="prefetch" href="/assets/index.html.1cf9b97a.js"><link rel="prefetch" href="/assets/index.html.6783e956.js"><link rel="prefetch" href="/assets/Built-inTypesAndMethods.html.6a6bb314.js"><link rel="prefetch" href="/assets/index.html.d00e9e45.js"><link rel="prefetch" href="/assets/index.html.7579bb0e.js"><link rel="prefetch" href="/assets/index.html.6eb43eb5.js"><link rel="prefetch" href="/assets/index.html.368c0ad8.js"><link rel="prefetch" href="/assets/index.html.10f6513e.js"><link rel="prefetch" href="/assets/index.html.c1838371.js"><link rel="prefetch" href="/assets/index.html.646a657a.js"><link rel="prefetch" href="/assets/index.html.96e3e11a.js"><link rel="prefetch" href="/assets/index.html.44d24fc0.js"><link rel="prefetch" href="/assets/index.html.5860f8d9.js"><link rel="prefetch" href="/assets/index.html.0cd4c1be.js"><link rel="prefetch" href="/assets/index.html.ae3ec48d.js"><link rel="prefetch" href="/assets/index.html.7bff8c2c.js"><link rel="prefetch" href="/assets/index.html.7b1c920b.js"><link rel="prefetch" href="/assets/index.html.8e18a882.js"><link rel="prefetch" href="/assets/index.html.8cf1ea5a.js"><link rel="prefetch" href="/assets/index.html.aa4d6c47.js"><link rel="prefetch" href="/assets/index.html.891eff9e.js"><link rel="prefetch" href="/assets/index.html.1d466d5f.js"><link rel="prefetch" href="/assets/index.html.25ec0724.js"><link rel="prefetch" href="/assets/index.html.da9590d3.js"><link rel="prefetch" href="/assets/index.html.23a1b346.js"><link rel="prefetch" href="/assets/index.html.6ba2983a.js"><link rel="prefetch" href="/assets/index.html.6b7f34ab.js"><link rel="prefetch" href="/assets/index.html.2efe1c06.js"><link rel="prefetch" href="/assets/index.html.6816dcdc.js"><link rel="prefetch" href="/assets/index.html.cacc9c2e.js"><link rel="prefetch" href="/assets/index.html.b29383df.js"><link rel="prefetch" href="/assets/index.html.a0fdd16f.js"><link rel="prefetch" href="/assets/index.html.fd4d7ec5.js"><link rel="prefetch" href="/assets/404.html.d8035c30.js"><link rel="prefetch" href="/assets/index.html.351d7b0c.js"><link rel="prefetch" href="/assets/index.html.6e958c39.js"><link rel="prefetch" href="/assets/markdown.html.65819959.js"><link rel="prefetch" href="/assets/index.html.a9bf9e55.js"><link rel="prefetch" href="/assets/index.html.7a52e4cf.js"><link rel="prefetch" href="/assets/index.html.6fec7d9b.js"><link rel="prefetch" href="/assets/index.html.d22f47bc.js"><link rel="prefetch" href="/assets/index.html.f06a02df.js"><link rel="prefetch" href="/assets/index.html.f2359518.js"><link rel="prefetch" href="/assets/CodeReadability.html.e5ccca8e.js"><link rel="prefetch" href="/assets/CodeReview.html.56c696b6.js"><link rel="prefetch" href="/assets/CSharpCodingStyle.html.ef13d84a.js"><link rel="prefetch" href="/assets/index.html.fdd644f4.js"><link rel="prefetch" href="/assets/UnitTesting.html.0f7d59d9.js"><link rel="prefetch" href="/assets/index.html.774c4145.js"><link rel="prefetch" href="/assets/index.html.347024bc.js"><link rel="prefetch" href="/assets/index.html.5142f8a4.js"><link rel="prefetch" href="/assets/index.html.a71d49bc.js"><link rel="prefetch" href="/assets/index.html.5c9b38a8.js"><link rel="prefetch" href="/assets/index.html.3bd3e1d4.js"><link rel="prefetch" href="/assets/index.html.ccce7f51.js"><link rel="prefetch" href="/assets/index.html.d3cee4ce.js"><link rel="prefetch" href="/assets/index.html.76197720.js"><link rel="prefetch" href="/assets/index.html.e9499368.js"><link rel="prefetch" href="/assets/index.html.88b6cab6.js"><link rel="prefetch" href="/assets/index.html.4aea1773.js"><link rel="prefetch" href="/assets/index.html.c6e15a8a.js"><link rel="prefetch" href="/assets/index.html.5bceb5c6.js"><link rel="prefetch" href="/assets/Built-inTypesAndMethods.html.fcb31074.js"><link rel="prefetch" href="/assets/index.html.301d7bed.js"><link rel="prefetch" href="/assets/index.html.8cf8ddca.js"><link rel="prefetch" href="/assets/index.html.e47c7bc6.js"><link rel="prefetch" href="/assets/index.html.4772932a.js"><link rel="prefetch" href="/assets/index.html.fb10aba3.js"><link rel="prefetch" href="/assets/index.html.9b4a02e1.js"><link rel="prefetch" href="/assets/index.html.4d6b6f82.js"><link rel="prefetch" href="/assets/index.html.2b6cd7f9.js"><link rel="prefetch" href="/assets/index.html.ed923e2a.js"><link rel="prefetch" href="/assets/index.html.d824f2b4.js"><link rel="prefetch" href="/assets/index.html.900905c6.js"><link rel="prefetch" href="/assets/index.html.87d6d222.js"><link rel="prefetch" href="/assets/index.html.0845e0c3.js"><link rel="prefetch" href="/assets/index.html.cd12b050.js"><link rel="prefetch" href="/assets/index.html.c8b5888e.js"><link rel="prefetch" href="/assets/index.html.eb67868e.js"><link rel="prefetch" href="/assets/index.html.61bf91e3.js"><link rel="prefetch" href="/assets/index.html.bbd700bd.js"><link rel="prefetch" href="/assets/index.html.51359b42.js"><link rel="prefetch" href="/assets/index.html.5387ba8f.js"><link rel="prefetch" href="/assets/index.html.1018baa6.js"><link rel="prefetch" href="/assets/index.html.3ad2cb97.js"><link rel="prefetch" href="/assets/index.html.79f39490.js"><link rel="prefetch" href="/assets/index.html.091ed843.js"><link rel="prefetch" href="/assets/index.html.208b871a.js"><link rel="prefetch" href="/assets/index.html.0eede34b.js"><link rel="prefetch" href="/assets/index.html.03dba5b4.js"><link rel="prefetch" href="/assets/index.html.5b604b3d.js"><link rel="prefetch" href="/assets/index.html.39825040.js"><link rel="prefetch" href="/assets/index.html.9fbe4ed0.js"><link rel="prefetch" href="/assets/404.html.071de283.js">
    <link rel="stylesheet" href="/assets/style.f35a7668.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/logo.png" alt="Code Cake"><span class="site-name can-hide">Code Cake</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/code/dotnet/" class="router-link-active" aria-label=".NET"><!--[--><!--]--> .NET <!--[--><!--]--></a></div><div class="navbar-item"><a href="/code/web/" class="" aria-label="WEB"><!--[--><!--]--> WEB <!--[--><!--]--></a></div><div class="navbar-item"><a href="/code/database/" class="" aria-label="Database"><!--[--><!--]--> Database <!--[--><!--]--></a></div><div class="navbar-item"><a href="/code/test/" class="" aria-label="Test"><!--[--><!--]--> Test <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/icodecake/icodecake.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/code/dotnet/" class="router-link-active" aria-label=".NET"><!--[--><!--]--> .NET <!--[--><!--]--></a></div><div class="navbar-item"><a href="/code/web/" class="" aria-label="WEB"><!--[--><!--]--> WEB <!--[--><!--]--></a></div><div class="navbar-item"><a href="/code/database/" class="" aria-label="Database"><!--[--><!--]--> Database <!--[--><!--]--></a></div><div class="navbar-item"><a href="/code/test/" class="" aria-label="Test"><!--[--><!--]--> Test <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/icodecake/icodecake.github.io" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">WPF <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/dotnet/WpfUILayout" class="sidebar-item" aria-label="WPF UI Layout"><!--[--><!--]--> WPF UI Layout <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/XAMLBinding" class="sidebar-item" aria-label="XAML Binding"><!--[--><!--]--> XAML Binding <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/Language" class="sidebar-item" aria-label="WPF 本地化"><!--[--><!--]--> WPF 本地化 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">C# <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><p tabindex="0" class="sidebar-item active">新特性 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/dotnet/CSharpNewFeatures/7.0/" class="sidebar-item" aria-label="7.0"><!--[--><!--]--> 7.0 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/CSharpNewFeatures/8.0/" class="sidebar-item" aria-label="8.0"><!--[--><!--]--> 8.0 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/CSharpNewFeatures/9.0/" class="sidebar-item" aria-label="9.0"><!--[--><!--]--> 9.0 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/code/dotnet/CSharpNewFeatures/10.0/" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="10.0"><!--[--><!--]--> 10.0 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/CSharpNewFeatures/11.0/" class="sidebar-item" aria-label="11.0"><!--[--><!--]--> 11.0 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">多线程 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/dotnet/Multithreading/BackgroundWorker/" class="sidebar-item" aria-label="BackgroundWorker"><!--[--><!--]--> BackgroundWorker <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/Multithreading/ThreadAndTask/" class="sidebar-item" aria-label="Thread and Task"><!--[--><!--]--> Thread and Task <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/Multithreading/Parallel/" class="sidebar-item" aria-label="Parallel"><!--[--><!--]--> Parallel <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/Multithreading/AsyncAndAwait/" class="sidebar-item" aria-label="Async and Await"><!--[--><!--]--> Async and Await <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">Json <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/dotnet/Json/" class="sidebar-item" aria-label="System.Text.Json"><!--[--><!--]--> System.Text.Json <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item">Log <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/dotnet/Log4Net/" class="sidebar-item" aria-label="Log4Net"><!--[--><!--]--> Log4Net <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/code/dotnet/Net5Publish/" class="sidebar-item" aria-label="VS2019 基于.NET5 单文件打包"><!--[--><!--]--> VS2019 基于.NET5 单文件打包 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/DynamicMeanNumber/" class="sidebar-item" aria-label="无缓存计算平均数"><!--[--><!--]--> 无缓存计算平均数 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/VideoCompression/" class="sidebar-item" aria-label="视频压缩"><!--[--><!--]--> 视频压缩 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/Speech/" class="sidebar-item" aria-label="语音识别"><!--[--><!--]--> 语音识别 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/HttpContext/" class="sidebar-item" aria-label="HttpContext.Items vs HttpContext.Features"><!--[--><!--]--> HttpContext.Items vs HttpContext.Features <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Other <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/code/dotnet/InvalidFileName" class="sidebar-item" aria-label="Win10 aux,com1~com9,prn,con,nul文件命名无效"><!--[--><!--]--> Win10 aux,com1~com9,prn,con,nul文件命名无效 <!--[--><!--]--></a><!----></li><li><a href="/code/dotnet/matlab" class="sidebar-item" aria-label="C#调用Matlab函数"><!--[--><!--]--> C#调用Matlab函数 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="csharp-10-0-新特性" tabindex="-1"><a class="header-anchor" href="#csharp-10-0-新特性" aria-hidden="true">#</a> CSharp 10.0 新特性</h1><h2 id="一、-安装必备" tabindex="-1"><a class="header-anchor" href="#一、-安装必备" aria-hidden="true">#</a> 一、 安装必备</h2><p>下载最新 6 .NET SDK。 还可以下载 Visual Studio 2022，其中包括 .NET 6 SDK。</p><h2 id="二、新特性" tabindex="-1"><a class="header-anchor" href="#二、新特性" aria-hidden="true">#</a> 二、新特性</h2><h3 id="_1-record-struct" tabindex="-1"><a class="header-anchor" href="#_1-record-struct" aria-hidden="true">#</a> 1.record struct</h3><p>首先自然是 record struct，解决了 record 只能给 class 而不能给 struct 用的问题：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">record</span> <span class="token class-name"><span class="token keyword">struct</span></span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> X<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">int</span></span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>用 record 定义 struct 的好处其实有很多，例如你无需重写 GetHashCode 和 Equals 之类的方法了。</p><p>sealed record ToString 方法 之前 record 的 ToString 是不能修饰为 sealed 的，因此如果你继承了一个 record，相应的 ToString 行为也会被改变，因此这是个虚方法。</p><p>但是现在你可以把 record 里的 ToString 方法标记成 sealed，这样你的 ToString 方法就不会被重写了。</p><h3 id="_2-struct-无参构造函数" tabindex="-1"><a class="header-anchor" href="#_2-struct-无参构造函数" aria-hidden="true">#</a> 2.struct 无参构造函数</h3><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">struct</span> <span class="token class-name">Foo</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token keyword">int</span></span> X<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> X <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是使用的时候就要注意了，因为无参构造函数的存在使得 new struct() 和 default(struct) 的语义不一样了，例如 new Foo().X == default(Foo).X 在上面这个例子中将会得出 false。</p><h3 id="_3-匿名对象的-with" tabindex="-1"><a class="header-anchor" href="#_3-匿名对象的-with" aria-hidden="true">#</a> 3.匿名对象的 with</h3><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> A <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> B <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> y <span class="token operator">=</span> x <span class="token keyword">with</span> <span class="token punctuation">{</span> A <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这里 y.A 将会是 3 。</p><h3 id="_4-全局的-using" tabindex="-1"><a class="header-anchor" href="#_4-全局的-using" aria-hidden="true">#</a> 4.全局的 using</h3><p>利用全局 using 可以给整个项目启用 usings，不再需要每个文件都写一份。比如你可以创建一个 Import.cs，然后里面写：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">global</span> <span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">global</span> <span class="token keyword">using</span> <span class="token class-name">i32</span> <span class="token operator">=</span> <span class="token class-name">System<span class="token punctuation">.</span>Int32</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>然后你整个项目都无需再 using System，并且可以用 i32 了。</p><h3 id="_5-文件范围的-namespace" tabindex="-1"><a class="header-anchor" href="#_5-文件范围的-namespace" aria-hidden="true">#</a> 5.文件范围的 namespace</h3><p>这个比较简单，以前写 namespace 还得带一层大括号，以后如果一个文件里只有一个 namespace 的话，那直接在最上面这样写就行了：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">namespace</span> <span class="token namespace">MyNamespace</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_6-常量字符串插值" tabindex="-1"><a class="header-anchor" href="#_6-常量字符串插值" aria-hidden="true">#</a> 6.常量字符串插值</h3><p>你可以给 const string 使用字符串插值了，非常方便：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> x <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token class-name"><span class="token keyword">string</span></span> y <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">x</span><span class="token punctuation">}</span></span><span class="token string">, world!&quot;</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-lambda-改进" tabindex="-1"><a class="header-anchor" href="#_7-lambda-改进" aria-hidden="true">#</a> 7.lambda 改进</h3><ol><li>支持 attributes lambda 可以带 attribute 了：</li></ol><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Foo</span></span><span class="token punctuation">]</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">;</span> <span class="token comment">// 给 lambda 设置</span>
f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">return</span><span class="token punctuation">:</span> <span class="token class-name">Foo</span></span><span class="token punctuation">]</span> <span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">;</span> <span class="token comment">// 给 lambda 返回值设置</span>
f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Foo</span></span><span class="token punctuation">]</span> x<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">;</span> <span class="token comment">// 给 lambda 参数设置</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>支持指定返回值类型 此前 C# 的 lambda 返回值类型靠推导，C# 10 开始允许在参数列表最前面显示指定 lambda 类型了：</li></ol><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>f <span class="token operator">=</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">4</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>支持 ref 、in 、out 等修饰</li></ol><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code>f <span class="token operator">=</span> <span class="token keyword">ref</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token keyword">ref</span> <span class="token class-name"><span class="token keyword">int</span></span> x<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">ref</span> x<span class="token punctuation">;</span> <span class="token comment">// 返回一个参数的引用</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="4"><li>头等函数 函数可以隐式转换到 delegate，于是函数上升至头等函数：</li></ol><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token class-name"><span class="token keyword">var</span></span> x <span class="token operator">=</span> Foo<span class="token punctuation">;</span>
<span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hello</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>自然委托类型 lambda 现在会自动创建自然委托类型，于是不再需要写出类型了。</li></ol><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Func&lt;int&gt;</span>
<span class="token class-name"><span class="token keyword">var</span></span> g <span class="token operator">=</span> <span class="token keyword">string</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> x<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> y<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">y</span><span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">x</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">;</span> <span class="token comment">// Func&lt;int, string, string&gt;</span>
<span class="token class-name"><span class="token keyword">var</span></span> h <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">.</span>GetHashCode<span class="token punctuation">;</span> <span class="token comment">// Func&lt;int&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-callerargumentexpression" tabindex="-1"><a class="header-anchor" href="#_8-callerargumentexpression" aria-hidden="true">#</a> 8.CallerArgumentExpression</h3><p>现在，CallerArgumentExpression 这个 attribute 终于有用了。借助这个 attribute，编译器会自动填充调用参数的表达式字符串，例如：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CallerArgumentExpression</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span> <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> expression <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>expression <span class="token operator">+</span> <span class="token string">&quot; = &quot;</span> <span class="token operator">+</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当你调用 Foo(4 + 5) 时，会输出 4 + 5 = 9。这对测试框架极其有用，因为你可以输出 assert 的原表达式了：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Assert</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">bool</span></span> <span class="token keyword">value</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">CallerArgumentExpression</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span> <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">?</span></span> expr <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">value</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AssertFailureException</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-tuple-支持混合定义和使用" tabindex="-1"><a class="header-anchor" href="#_9-tuple-支持混合定义和使用" aria-hidden="true">#</a> 9.tuple 支持混合定义和使用</h3><p>比如：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">int</span></span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">var</span></span> z<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>于是 y 就变成 2 了，同时还创建了两个变量 x 和 z，分别是 1 和 3 。</p><h3 id="_10-接口支持抽象静态方法" tabindex="-1"><a class="header-anchor" href="#_10-接口支持抽象静态方法" aria-hidden="true">#</a> 10.接口支持抽象静态方法</h3><p>这个特性将会在 .NET 6 作为 preview 特性放出，意味着默认是不启用的，需要设置<!----> 和 <!---->，然后引入一个官方的 nuget 包 System.Runtime.Experimental 来启用。 然后接口就可以声明抽象静态成员了，.NET 的类型系统正式具备虚静态方法分发能力。 例如，你想定义一个可加而且有零的接口 <code>IMonoid&lt;T&gt;</code></p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">interface</span> <span class="token class-name">IMonoid<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token keyword">where</span> <span class="token class-name">T</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IMonoid<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> <span class="token keyword">static</span> <span class="token return-type class-name">T</span> Zero <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">abstract</span> <span class="token keyword">static</span> T <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token class-name">T</span> l<span class="token punctuation">,</span> <span class="token class-name">T</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后可以对其进行实现，例如这里的 MyInt：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyInt</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IMonoid<span class="token punctuation">&lt;</span>MyInt<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">MyInt</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">int</span></span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span> Value <span class="token operator">=</span> val<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">MyInt</span> Zero <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MyInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> MyInt <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token class-name">MyInt</span> l<span class="token punctuation">,</span> <span class="token class-name">MyInt</span> r<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MyInt</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>Value <span class="token operator">+</span> r<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Value <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后就能写出一个方法对 <code>IMoniod&lt;T&gt;</code> 进行求和了，这里为了方便写成扩展方法：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">IMonoidExtensions</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">Sum</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IEnumerable<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> t<span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token class-name">T</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IMonoid<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> T<span class="token punctuation">.</span>Zero<span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> i <span class="token keyword">in</span> t<span class="token punctuation">)</span> result <span class="token operator">+=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后调用：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">List<span class="token punctuation">&lt;</span>MyInt<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>你可能会问为什么要引入一个 <code>System.Runtime.Experimental</code>，因为这个包里面包含了 .NET 基础类型的改进：给所有的基础类型都实现了相应的接口，比如给数值类型都实现了 <code>INumber&lt;T&gt;</code>，给可以加的东西都实现了 <code>IAdditionOperators&lt;TLeft, TRight, TResult&gt;</code> 等等，用起来将会非常方便，比如你想写一个函数，这个函数用来把能相加的东西加起来：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token return-type class-name">T</span> <span class="token generic-method"><span class="token function">Add</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token class-name">T</span> left<span class="token punctuation">,</span> <span class="token class-name">T</span> right<span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token class-name">T</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IAdditionOperators<span class="token punctuation">&lt;</span>T<span class="token punctuation">,</span> T<span class="token punctuation">,</span> T<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> left <span class="token operator">+</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>就搞定了。</p><h3 id="_11-泛型-attribute" tabindex="-1"><a class="header-anchor" href="#_11-泛型-attribute" aria-hidden="true">#</a> 11.泛型 attribute</h3><p>C# 的 attributes 支持泛型了，不过 .NET 6 中将以预览特定放出，因此需要 <code>&lt;LangVersion&gt;preview&lt;/LangVersion&gt;</code></p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">class</span> <span class="token class-name">TestAttribute<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">Attribute</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">T</span> Data <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token function">TestAttribute</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span> Data <span class="token operator">=</span> data<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后你就能这么用了：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token generic-method"><span class="token function">Test</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">int</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token generic-method"><span class="token function">Test</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">4.5f</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token generic-method"><span class="token function">Test</span><span class="token generic class-name"><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_12-允许在方法上指定-asyncmethodbuilder" tabindex="-1"><a class="header-anchor" href="#_12-允许在方法上指定-asyncmethodbuilder" aria-hidden="true">#</a> 12.允许在方法上指定 AsyncMethodBuilder</h3><p>C# 10 将允许方法上使用 <code>[AsyncMethodBuilder(...)]</code> 来使用你自己实现的 async method builder，代替自带的 Task 或者 ValueTask 的异步方法构造器。这也有助于你自己实现零开销的异步方法。</p><h3 id="_13-嵌套属性模式匹配改进" tabindex="-1"><a class="header-anchor" href="#_13-嵌套属性模式匹配改进" aria-hidden="true">#</a> 13.嵌套属性模式匹配改进</h3><p>以前在匹配嵌套属性的时候需要这么写：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token keyword">is</span> <span class="token punctuation">{</span> X<span class="token punctuation">:</span> <span class="token punctuation">{</span> Y<span class="token punctuation">:</span> <span class="token punctuation">{</span> Z<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>现在只需要简单的：</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token keyword">is</span> <span class="token punctuation">{</span> X<span class="token punctuation">.</span>Y<span class="token punctuation">.</span>Z<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token range operator">..</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>就可以了。</p><h1 id="参考链接" tabindex="-1"><a class="header-anchor" href="#参考链接" aria-hidden="true">#</a> 参考链接</h1><ul><li><a href="https://docs.microsoft.com/zh-cn/dotnet/csharp/whats-new/csharp-10" target="_blank" rel="noopener noreferrer">C# 10 中的新增功能<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: ryning@sina.com">Z小染</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/code/dotnet/CSharpNewFeatures/9.0/" class="" aria-label="9.0"><!--[--><!--]--> 9.0 <!--[--><!--]--></a></span><span class="next"><a href="/code/dotnet/CSharpNewFeatures/11.0/" class="" aria-label="11.0"><!--[--><!--]--> 11.0 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.cbfe9412.js" defer></script>
  </body>
</html>
